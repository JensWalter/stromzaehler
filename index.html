<html>

<body>
    <input type="file" accept="video/*;capture=camcorder">
    <video autoplay></video>
    <canvas ></canvas>
    <img >
</body>
<script>
    var stream;
    var errorCallback = function (e) {
        if(e.name=='OverconstrainedError'){
            navigator.getUserMedia({video:true,audio:false}, gotStream, errorCallback);
        }else{
            console.log(e);
            alert('Reeeejected!', e);
        }
    };
    var vgaConstraints = {video: {facingMode: {exact: 'environment'}},audio: false};
    navigator.getUserMedia(vgaConstraints, gotStream, errorCallback);
    function gotStream(localMediaStream) {
        stream = localMediaStream;
        var video = document.querySelector('video');
        video.src = window.URL.createObjectURL(localMediaStream);

        const track = localMediaStream.getVideoTracks()[0];
        video.addEventListener('loadedmetadata', (e) => {
            window.setTimeout(() => (
                onCapabilitiesReady(track.getCapabilities())
            ), 500);
        });
    }
    function takepicture() {
        let canvas = document.querySelector('canvas');
        let video = document.querySelector('video');
        let photo = document.querySelector('img');
        const context = canvas.getContext('2d');
        context.drawImage(video, 0, 0, 640, 480);
        const data = canvas.toDataURL('image/png');
        photo.setAttribute('src', data);
    }
    function onCapabilitiesReady(capabilities) {
        if (capabilities.torch) {
            alert('enable torch');
            track.applyConstraints({
                advanced: [{ torch: true }]
            }).catch(e => console.log(e));
        }else{
            alert('no torch found');
        }
    }
    function run(){
        takepicture()
    }
    setInterval(run,10000);
</script>

</html>